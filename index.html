<!doctype html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Navid Rahmani: Producer Portfolio</title>

  <!-- Ø§Ø³ØªØ§ÛŒÙ„ Ø¨Ø§ Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Ú©ØªØ§Ø¨Ø®Ø§Ù†Ù‡ QR -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"
          integrity="sha512-CNgI+PvfSaH0YzZp0yDW8s0kL9sZf1R8Q9vuuqUj5hT1o4d7q9gH9B2v3F9zj7+zVQhVYt8NwS1f+7x7YkBv3g=="
          crossorigin="anonymous" referrerpolicy="no-referrer"></script>

  <style>
    @media print { 
      #controls, #input-form, #log, #audio-controls { display: none !important; } 
      #grid { grid-template-columns: repeat(3, minmax(0, 1fr)); }
      #all-qrs { display: block !important; }
    }
    .mono { font-family: ui-monospace, Menlo, Consolas, monospace; }
    /* Ø§Ù†ÛŒÙ…ÛŒØ´Ù† ÙˆØ±ÙˆØ¯ Ú©Ø§Ø±Øª */
    @keyframes slideIn { from { transform: translateY(20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
    .animate-slideIn { animation: slideIn 0.5s ease-out; }
    /* Ø§Ù†ÛŒÙ…ÛŒØ´Ù† Ø¨Ù†Ø± */
    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    .banner { animation: fadeIn 1s ease-in; }
    /* Ø§ÙÚ©Øª hover Ø¨Ø±Ø§ÛŒ QR */
    .qr-hover:hover { transform: scale(1.05); transition: transform 0.3s ease; }
    /* Ø§Ù†ÛŒÙ…ÛŒØ´Ù† Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ QR */
    @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    .loading::after {
      content: '';
      display: inline-block;
      width: 16px; height: 16px;
      border: 2px solid #fff;
      border-top-color: #3b82f6;
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin-right: 8px;
    }
    /* Ø§ÙÚ©Øª ÙØ§Ù†ØªØ²ÛŒ Ø¯Ú©Ù…Ù‡ Ù¾Ø±ÛŒÙ†Øª */
    @keyframes glow { 
      0% { box-shadow: 0 0 5px rgba(255,255,255,0.5); } 
      50% { box-shadow: 0 0 20px rgba(255,255,255,0.8); } 
      100% { box-shadow: 0 0 5px rgba(255,255,255,0.5); } 
    }
    .fancy-btn:hover {
      transform: scale(1.1);
      animation: glow 1.5s infinite;
    }
  </style>
</head>
<body style="background-image: url('https://navidrahmani94.github.io/music-qr-portfolio/assets/videos/146291855-grunge-musical-background-old-paper-texture-music-notes.jpg'); background-size: cover; background-attachment: fixed;">
  <!-- Ø¨Ù†Ø± -->
  <header class="sticky top-0 z-10 bg-gradient-to-r from-blue-600 to-indigo-600 text-white shadow-lg banner">
    <div class="max-w-5xl mx-auto px-4 py-4 relative">
      <div id="controls" class="flex justify-center items-center gap-3">
        <div class="flex flex-col items-center gap-1">
          <span class="text-2xl font-bold">Producer Portfolio</span>
          <span class="text-xl font-medium">Navid Rahmani</span>
        </div>
      </div>
      <div class="absolute left-4 top-1/2 transform -translate-y-1/2">
        <button id="print" class="border border-white/20 rounded px-4 py-2 text-sm bg-gradient-to-r from-blue-500 to-indigo-500 hover:from-blue-600 hover:to-indigo-600 transition fancy-btn flex items-center gap-2">
          <span>ğŸ–¨ï¸</span>
          <span>Ù¾Ø±ÛŒÙ†Øª QR</span>
        </button>
      </div>
    </div>
  </header>

  <main class="max-w-5xl mx-auto px-4 py-8">
    <!-- ÙØ±Ù… Ø¨Ø±Ø§ÛŒ Ø§Ù†ØªØ®Ø§Ø¨ Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒ Ùˆ Ù„ÛŒÙ†Ú© ÙˆÛŒØ¯ÛŒÙˆ -->
    <div id="input-form" class="mb-6 bg-white/80 p-6 rounded-xl shadow-md animate-slideIn backdrop-blur-sm">
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div>
          <label for="category" class="block text-sm font-medium">Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒ:</label>
          <select id="category" class="mt-1 p-2 border rounded w-full">
            <option value="all">Ù‡Ù…Ù‡</option>
            <option value="mix_master">Mix and Master</option>
            <option value="sound_design">Sound Design</option>
            <option value="producer_project">Producer Project</option>
            <option value="sound_recording">Sound Recording</option>
          </select>
        </div>
        <div>
          <label for="videoUrl" class="block text-sm font-medium">Ù„ÛŒÙ†Ú© ÙˆÛŒØ¯ÛŒÙˆÛŒ Ø¬Ø¯ÛŒØ¯:</label>
          <input id="videoUrl" type="url" class="mt-1 p-2 border rounded w-full" placeholder="https://example.com/video.mp4">
        </div>
      </div>
      <button id="generateQR" class="mt-4 px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition">ØªÙˆÙ„ÛŒØ¯ QR</button>
    </div>

    <!-- Ù„Ø§Ú¯ Ø¨Ø±Ø§ÛŒ Ø¹ÛŒØ¨â€ŒÛŒØ§Ø¨ÛŒ -->
    <pre id="log" class="mono text-xs bg-white/80 border rounded p-3 mb-4 whitespace-pre-wrap backdrop-blur-sm"></pre>

    <!-- Ú©Ø§Ø±Øª -->
    <div id="card" class="overflow-hidden rounded-2xl shadow-md bg-white/80 border flex flex-col animate-slideIn backdrop-blur-sm"></div>

    <!-- Ø¨Ø®Ø´ Ù¾Ø±ÛŒÙ†Øª Ù‡Ù…Ù‡ QRÙ‡Ø§ -->
    <div id="all-qrs" class="hidden mt-8 grid grid-cols-1 md:grid-cols-3 gap-4"></div>
  </main>

  <footer class="border-t bg-white/70 backdrop-blur-sm">
    <div class="max-w-5xl mx-auto px-4 py-6 text-xs text-neutral-500 flex items-center justify-between">
      <div>Â© <span id="year"></span> Navid Rahmani: Producer Portfolio</div>
      <div id="audio-controls" class="flex items-center gap-2">
        <button id="toggle-audio" class="px-2 py-1 rounded hover:bg-neutral-100">ØªÙˆÙ‚Ù Ù…ÙˆØ³ÛŒÙ‚ÛŒ</button>
      </div>
      <button id="copy" class="px-2 py-1 rounded hover:bg-neutral-100">Ú©Ù¾ÛŒ Ø¢Ø¯Ø±Ø³ ØµÙØ­Ù‡</button>
    </div>
    <audio id="background-audio" autoplay loop>
      <source src="https://navidrahmani94.github.io/music-qr-portfolio/assets/background.mp3" type="audio/mp3">
    </audio>
  </footer>

  <script>
    // â€”â€”â€” ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø§ÙˆÙ„ÛŒÙ‡ â€”â€”â€”
    const QR_SIZE = 148;
    let VIDEO_URL = "https://navidrahmani94.github.io/music-qr-portfolio/assets/videos/logo%20M.mp4"; // Ù¾ÛŒØ´â€ŒÙØ±Ø¶

    // â€”â€”â€” Ù„ÛŒØ³Øª ÙˆÛŒØ¯ÛŒÙˆÙ‡Ø§ Ø¨Ø§ Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒ Ùˆ ØªÙˆØ¶ÛŒØ­Ø§Øª â€”â€”â€”
    const videos = [
      { 
        category: "mix_master", 
        title: "Mix and Master Sample", 
        url: "https://navidrahmani94.github.io/music-qr-portfolio/assets/videos/logo%20M.mp4",
        description: "Ù†Ù…ÙˆÙ†Ù‡â€ŒØ§ÛŒ Ø§Ø² Ù…ÛŒÚ©Ø³ Ùˆ Ù…Ø³ØªØ±ÛŒÙ†Ú¯ Ø­Ø±ÙÙ‡â€ŒØ§ÛŒ Ø¨Ø§ Ú©ÛŒÙÛŒØª Ø§Ø³ØªÙˆØ¯ÛŒÙˆÛŒÛŒ."
      },
      { 
        category: "sound_design", 
        title: "Sound Design Demo", 
        url: "https://example.com/sound-design.mp4",
        description: "Ø·Ø±Ø§Ø­ÛŒ ØµØ¯Ø§ Ø¨Ø±Ø§ÛŒ Ù¾Ø±ÙˆÚ˜Ù‡â€ŒÙ‡Ø§ÛŒ Ø³ÛŒÙ†Ù…Ø§ÛŒÛŒ Ùˆ Ø¨Ø§Ø²ÛŒâ€ŒÙ‡Ø§ÛŒ ÙˆÛŒØ¯ÛŒÙˆÛŒÛŒ."
      },
      { 
        category: "producer_project", 
        title: "Producer Project 1", 
        url: "https://example.com/producer-project.mp4",
        description: "Ù¾Ø±ÙˆÚ˜Ù‡ ØªÙˆÙ„ÛŒØ¯ Ù…ÙˆØ³ÛŒÙ‚ÛŒ Ú©Ø§Ù…Ù„ Ø§Ø² Ø§ÛŒØ¯Ù‡ ØªØ§ Ù…Ø­ØµÙˆÙ„ Ù†Ù‡Ø§ÛŒÛŒ."
      },
      { 
        category: "sound_recording", 
        title: "Sound Recording Session", 
        url: "https://example.com/sound-recording.mp4",
        description: "Ø¬Ù„Ø³Ù‡ Ø¶Ø¨Ø· ØµØ¯Ø§ Ø¨Ø§ ØªØ¬Ù‡ÛŒØ²Ø§Øª Ù¾ÛŒØ´Ø±ÙØªÙ‡ Ø¯Ø± Ø§Ø³ØªÙˆØ¯ÛŒÙˆ."
      }
    ];

    // â€”â€”â€” Ú©Ù…Ú©â€ŒÙ‡Ø§ â€”â€”â€”
    const logEl = document.getElementById("log");
    function log(...args) { logEl.textContent += args.join(" ") + "\n"; }

    function makeQRWithLib(container, text) {
      try {
        if (typeof QRCode === "function") {
          container.innerHTML = "";
          new QRCode(container, { text, width: QR_SIZE, height: QR_SIZE });
          const img = container.querySelector("img");
          if (!img) {
            const canvas = container.querySelector("canvas");
            if (canvas) {
              const i = new Image();
              i.src = canvas.toDataURL("image/png");
              i.width = QR_SIZE; i.height = QR_SIZE;
              i.className = "rounded border qr-hover";
              container.innerHTML = "";
              container.appendChild(i);
            }
          } else {
            img.width = QR_SIZE; img.height = QR_SIZE;
            img.className = "rounded border qr-hover";
          }
          return true;
        }
      } catch (e) { log("QR lib error:", e.message); }
      return false;
    }

    function makeQRFallbackIMG(container, text) {
      const url = `https://api.qrserver.com/v1/create-qr-code/?size=${QR_SIZE}x${QR_SIZE}&data=${encodeURIComponent(text)}`;
      const img = new Image();
      img.src = url;
      img.width = QR_SIZE; img.height = QR_SIZE;
      img.alt = "QR";
      img.className = "rounded border qr-hover";
      container.innerHTML = "";
      container.appendChild(img);
      return img;
    }

    // â€”â€”â€” UI Ø§Ø¨ØªØ¯Ø§ÛŒÛŒ â€”â€”â€”
    document.getElementById("year").textContent = new Date().getFullYear();
    document.getElementById("print").onclick = () => window.print();
    document.getElementById("copy").onclick = () => navigator.clipboard.writeText(location.href);

    // â€”â€”â€” Ú©Ù†ØªØ±Ù„ Ù…ÙˆØ³ÛŒÙ‚ÛŒ Ù¾Ø³â€ŒØ²Ù…ÛŒÙ†Ù‡ â€”â€”â€”
    const audio = document.getElementById("background-audio");
    const toggleAudioBtn = document.getElementById("toggle-audio");
    audio.volume = 0.2; // ØµØ¯Ø§ÛŒ Ú©Ù… Ø¨Ø±Ø§ÛŒ Ù¾Ø³â€ŒØ²Ù…ÛŒÙ†Ù‡
    toggleAudioBtn.onclick = () => {
      if (audio.paused) {
        audio.play();
        toggleAudioBtn.textContent = "ØªÙˆÙ‚Ù Ù…ÙˆØ³ÛŒÙ‚ÛŒ";
      } else {
        audio.pause();
        toggleAudioBtn.textContent = "Ø´Ø±ÙˆØ¹ Ù…ÙˆØ³ÛŒÙ‚ÛŒ";
      }
    };

    // â€”â€”â€” ØªØ§Ø¨Ø¹ Ø¨Ø±Ø§ÛŒ Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ú©Ø§Ø±Øª â€”â€”â€”
    function updateCard(videoUrl, title = "ÙˆÛŒØ¯ÛŒÙˆ", description = "") {
      const card = document.getElementById("card");
      card.innerHTML = ""; // Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† Ù…Ø­ØªÙˆØ§ÛŒ Ù‚Ø¨Ù„ÛŒ

      // â€”â€”â€” Ù†Ø§Ù… ÙˆÛŒØ¯ÛŒÙˆ â€”â€”â€”
      const titleDiv = document.createElement("div");
      titleDiv.className = "text-center font-semibold text-xl py-4 bg-gray-50/80";
      titleDiv.textContent = title;
      card.appendChild(titleDiv);

      // â€”â€”â€” ÙˆÛŒØ¯ÛŒÙˆ â€”â€”â€”
      const media = document.createElement("div");
      const vid = document.createElement("video");
      vid.controls = true;
      vid.preload = "metadata";
      vid.className = "w-full h-80 object-contain bg-black";
      const src = document.createElement("source");
      src.src = videoUrl; src.type = "video/mp4";
      vid.appendChild(src);
      media.appendChild(vid);
      card.appendChild(media);

      // Ø§Ú¯Ø± Ù¾Ø®Ø´ Ø®Ø·Ø§ Ø¯Ø§Ø´ØªØŒ Ù¾ÛŒØ§Ù… Ø¨Ø¯Ù‡
      vid.addEventListener("error", () => {
        const err = vid.error, map = {1:"ABORTED",2:"NETWORK",3:"DECODE",4:"SRC_NOT_SUPPORTED"};
        const code = err?.code || 0;
        log("VIDEO_ERROR code=" + code + " (" + (map[code]||"UNKNOWN") + ")");
        const warn = document.createElement("div");
        warn.className = "p-3 mt-2 text-sm rounded bg-red-50 border text-red-700";
        warn.textContent = "Ù¾Ø®Ø´ ÙˆÛŒØ¯ÛŒÙˆ Ø®Ø·Ø§ Ø¯Ø§Ø¯: code=" + code + " (" + (map[code]||"UNKNOWN") + ") â€” Ø§Ú¯Ø± 404 Ø§Ø³Øª Ù…Ø³ÛŒØ±/Ù†Ø§Ù… ÙØ§ÛŒÙ„ Ø±Ø§ Ú†Ú© Ú©Ù†Ø› Ø§Ú¯Ø± DECODE Ø§Ø³Øª ÙØ§ÛŒÙ„ Ø±Ø§ Ø¨Ù‡ H.264/AAC ØªØ¨Ø¯ÛŒÙ„ Ú©Ù†.";
        media.appendChild(warn);
      });

      // â€”â€”â€” Ø¨Ø¯Ù†Ù‡ + QR â€”â€”â€”
      const body = document.createElement("div");
      body.className = "p-6";
      body.innerHTML = `
        <div class="mt-2 text-sm text-neutral-600 break-all">
          Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ…: <a class="underline text-blue-600 hover:text-blue-800" href="${videoUrl}" target="_blank" rel="noreferrer">${videoUrl}</a>
        </div>
        <div class="mt-2 text-sm text-neutral-600">${description}</div>
      `;
      const row = document.createElement("div");
      row.className = "mt-4 flex items-center gap-4";

      const qrBox = document.createElement("div");
      qrBox.id = "qrBox";
      qrBox.className = "relative";
      row.appendChild(qrBox);

      const actions = document.createElement("div");
      actions.className = "flex flex-col gap-3";
      const open = document.createElement("a");
      open.className = "px-4 py-2 rounded bg-blue-600 text-white text-sm hover:bg-blue-700 transition";
      open.href = videoUrl; open.target = "_blank"; open.rel = "noreferrer"; open.textContent = "Ø¨Ø§Ø² Ú©Ø±Ø¯Ù†";
      const copyBtn = document.createElement("button");
      copyBtn.className = "px-4 py-2 rounded border text-sm hover:bg-neutral-100 transition";
      copyBtn.textContent = "Ú©Ù¾ÛŒ Ù„ÛŒÙ†Ú©";
      copyBtn.onclick = () => navigator.clipboard.writeText(videoUrl);
      const dl = document.createElement("a");
      dl.className = "px-4 py-2 rounded border text-sm hover:bg-neutral-100 transition";
      dl.textContent = "Ø¯Ø§Ù†Ù„ÙˆØ¯ QR";
      dl.id = "dlQR";
      const printAll = document.createElement("button");
      printAll.className = "px-4 py-2 rounded border text-sm hover:bg-neutral-100 transition";
      printAll.textContent = "Ù¾Ø±ÛŒÙ†Øª Ù‡Ù…Ù‡ QRÙ‡Ø§";
      printAll.onclick = () => {
        generateAllQRs();
        setTimeout(() => window.print(), 1000);
      };
      actions.append(open, copyBtn, dl, printAll);
      row.appendChild(actions);

      body.appendChild(row);
      card.appendChild(body);

      // â€”â€”â€” Ø³Ø§Ø®Øª QR â€”â€”â€”
      let qrImgElement = null;
      qrBox.innerHTML = "<span class='loading'>Ø¯Ø± Ø­Ø§Ù„ ØªÙˆÙ„ÛŒØ¯ QR...</span>";
      setTimeout(() => {
        const ok = makeQRWithLib(qrBox, videoUrl);
        if (ok) {
          qrImgElement = qrBox.querySelector("img") || qrBox.querySelector("canvas");
        } else {
          qrImgElement = makeQRFallbackIMG(qrBox, videoUrl);
        }

        // Ù„ÛŒÙ†Ú© Ø¯Ø§Ù†Ù„ÙˆØ¯ QR
        const dlLink = document.getElementById("dlQR");
        if (qrImgElement.tagName.toLowerCase() === "img" && qrImgElement.src.startsWith("data:")) {
          dlLink.href = qrImgElement.src;
        } else {
          dlLink.href = qrImgElement.src || videoUrl;
        }
        dlLink.download = `${title.replace(/\s+/g, '_')}-qr.png`;
      }, 500);
    }

    // â€”â€”â€” ØªØ§Ø¨Ø¹ Ø¨Ø±Ø§ÛŒ Ù¾Ø±ÛŒÙ†Øª Ù‡Ù…Ù‡ QRÙ‡Ø§ â€”â€”â€”
    function generateAllQRs() {
      const allQrs = document.getElementById("all-qrs");
      allQrs.innerHTML = "";
      allQrs.className = "mt-8 grid grid-cols-1 md:grid-cols-3 gap-4 animate-slideIn";

      videos.forEach((video, index) => {
        const qrCard = document.createElement("div");
        qrCard.className = "bg-white/80 p-4 rounded-lg shadow-md text-center backdrop-blur-sm";
        qrCard.innerHTML = `
          <div class="font-semibold text-sm mb-2">${video.title}</div>
          <div class="text-xs text-neutral-600 mb-2">${video.description}</div>
        `;
        const qrBox = document.createElement("div");
        qrBox.id = `qr-all-${index}`;
        qrBox.className = "relative mx-auto";
        qrCard.appendChild(qrBox);
        allQrs.appendChild(qrCard);

        setTimeout(() => {
          const ok = makeQRWithLib(qrBox, video.url);
          if (!ok) {
            makeQRFallbackIMG(qrBox, video.url);
          }
        }, 100 * index);
      });

      allQrs.classList.remove("hidden");
    }

    // â€”â€”â€” Ø±ÙˆÛŒØ¯Ø§Ø¯Ù‡Ø§ â€”â€”â€”
    document.getElementById("generateQR").onclick = () => {
      const videoUrlInput = document.getElementById("videoUrl").value;
      if (videoUrlInput) {
        VIDEO_URL = videoUrlInput;
        log("NEW_VIDEO_URL =", VIDEO_URL);
        updateCard(VIDEO_URL, "ÙˆÛŒØ¯ÛŒÙˆÛŒ Ø³ÙØ§Ø±Ø´ÛŒ", "Ù„ÛŒÙ†Ú© ÙˆÛŒØ¯ÛŒÙˆÛŒ ÙˆØ§Ø±Ø¯Ø´Ø¯Ù‡ ØªÙˆØ³Ø· Ú©Ø§Ø±Ø¨Ø±.");
        document.getElementById("all-qrs").classList.add("hidden");
      } else {
        log("Ù„Ø·ÙØ§Ù‹ Ù„ÛŒÙ†Ú© ÙˆÛŒØ¯ÛŒÙˆÛŒ Ù…Ø¹ØªØ¨Ø± ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯.");
      }
    };

    document.getElementById("category").onchange = (e) => {
      const category = e.target.value;
      if (category === "all") {
        updateCard(VIDEO_URL);
        document.getElementById("all-qrs").classList.add("hidden");
        return;
      }
      const video = videos.find(v => v.category === category);
      if (video) {
        VIDEO_URL = video.url;
        log("CATEGORY_VIDEO_URL =", VIDEO_URL);
        updateCard(VIDEO_URL, video.title, video.description);
        document.getElementById("all-qrs").classList.add("hidden");
      }
    };

    // â€”â€”â€” Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø§ÙˆÙ„ÛŒÙ‡ â€”â€”â€”
    updateCard(VIDEO_URL, videos[0].title, videos[0].description);
  </script>
</body>
</html>
